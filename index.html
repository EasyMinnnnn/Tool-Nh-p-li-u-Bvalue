<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>üß† Auto Fill Executor</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 40px auto;
      max-width: 800px;
      padding: 0 20px;
    }
    textarea {
      width: 100%;
      height: 300px;
      font-family: monospace;
      font-size: 14px;
      padding: 10px;
    }
    button {
      margin-top: 10px;
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
      background-color: #2d89ef;
      color: white;
      border: none;
      border-radius: 4px;
    }
    button:hover {
      background-color: #1b66c9;
    }
  </style>
</head>
<body>
  <h2>üß† Auto Fill Executor</h2>
  <p>D√°n ƒëo·∫°n JavaScript t·ª´ Google Sheet v√†o √¥ b√™n d∆∞·ªõi, r·ªìi b·∫•m "Run".</p>
  <textarea id="code" placeholder="(function(){ ... })(); // m√£ t·ª´ Google Sheets"></textarea><br/>
  <button onclick="runCode()">‚ñ∂Ô∏è Run</button>

  <script>
    function runCode() {
      let raw = document.getElementById("code").value;

      // ‚úÖ B∆∞·ªõc 1: S·ª≠a c√°c l·ªói th∆∞·ªùng g·∫∑p t·ª´ Google Sheets
      raw = raw
        .replace(/""/g, '"')           // Excel xu·∫•t "" thay v√¨ "
        .replace(/[‚Äú‚Äù]/g, '"')         // d·∫•u ngo·∫∑c k√©p ti·∫øng Vi·ªát
        .replace(/[‚Äò‚Äô]/g, "'");        // d·∫•u nh√°y ƒë∆°n ti·∫øng Vi·ªát

      // ‚úÖ B∆∞·ªõc 2: C·∫£nh b√°o n·∫øu ng∆∞·ªùi d√πng ch∆∞a b·ªçc trong (function(){...})()
      if (!raw.trim().startsWith("(function")) {
        if (!confirm("‚ö†Ô∏è M√£ d√°n v√†o kh√¥ng ph·∫£i d·∫°ng h√†m. V·∫´n ch·∫°y?")) return;
      }

      try {
        if (!confirm("B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën ch·∫°y ƒëo·∫°n m√£ n√†y?")) return;
        eval(raw);
      } catch (err) {
        alert("‚ùå L·ªói khi ch·∫°y m√£: " + err.message);
        console.error(err);
      }
    }
  </script>
</body>
</html>
