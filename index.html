<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>üß† Auto Fill Executor</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 40px auto;
      max-width: 800px;
    }
    textarea {
      width: 100%;
      height: 300px;
      font-family: monospace;
      font-size: 14px;
    }
    button {
      margin-top: 10px;
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
    }
    label {
      display: block;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <h2>üß† Auto Fill Executor</h2>
  <p>D√°n ƒëo·∫°n JavaScript t·ª´ Google Sheets v√†o √¥ b√™n d∆∞·ªõi, r·ªìi b·∫•m "Run".</p>

  <textarea id="code" placeholder="D√°n code t·ª´ Google Sheet v√†o ƒë√¢y..."></textarea>

  <label>
    <input type="checkbox" id="fromExcel" checked>
    M√£ d√°n t·ª´ Google Sheets (x·ª≠ l√Ω chu·ªói `""`)
  </label>

  <button onclick="runCode()">‚ñ∂Ô∏è Run</button>

  <script>
    function runCode() {
      let raw = document.getElementById("code").value.trim();

      // 1. B·ªè d·∫•u = "..." n·∫øu d√πng t·ª´ Google Sheets
      if (raw.startsWith("=\"") && raw.endsWith("\"")) {
        raw = raw.slice(2, -1);
      }

      // 2. X·ª≠ l√Ω escape chu·ªói t·ª´ Excel
      if (document.getElementById("fromExcel").checked) {
        raw = raw
          .replace(/""/g, '"')     // Excel: "" => "
          .replace(/\\"/g, '"')     // N·∫øu c√≥ escape l·ªói
          .replace(/\\n/g, '\n')    // Hi·ªán xu·ªëng d√≤ng
          .replace(/\\t/g, '\t');   // Tab n·∫øu c√≥
      }

      try {
        if (!confirm("B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën ch·∫°y ƒëo·∫°n m√£ n√†y?")) return;
        eval(raw);
      } catch (err) {
        alert("‚ùå L·ªói khi ch·∫°y m√£: " + err.message);
        console.error(err);
      }
    }
  </script>
</body>
</html>
