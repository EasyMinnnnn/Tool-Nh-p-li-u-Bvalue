<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>Auto Fill Executor</title>
  <style>
    body {
      font-family: sans-serif;
      max-width: 960px;
      margin: 2rem auto;
      padding: 2rem;
    }
    textarea {
      width: 100%;
      height: 300px;
      font-family: monospace;
      font-size: 14px;
    }
    button {
      margin-top: 1rem;
      padding: 0.5rem 1rem;
      font-size: 16px;
    }
  </style>
</head>
<body>
  <h1>üß† Auto Fill Executor</h1>
  <p>D√°n ƒëo·∫°n JavaScript t·ª´ Google Sheets v√†o √¥ b√™n d∆∞·ªõi, r·ªìi b·∫•m "Run".</p>
  <textarea id="codeInput" placeholder="D√°n code t·ª´ Google Sheet v√†o ƒë√¢y..."></textarea>
  <br />
  <button onclick="runCode()">‚ñ∂Ô∏è Run</button>

  <script>
    function runCode() {
      const raw = document.getElementById("codeInput").value;

      try {
        // N·∫øu ng∆∞·ªùi d√πng copy t·ª´ Excel d·∫°ng "=...", th√¨ lo·∫°i b·ªè ƒëo·∫°n ƒë√≥
        const cleaned = raw.replace(/^\s*=+/, "").trim();

        // Th·ª≠ x·ª≠ l√Ω JSON string n·∫øu c√≥ d·∫•u "" b·ªã d∆∞ (Excel double quote)
        const evalSafe = cleaned.replace(/""/g, '"');

        // G√°n l·∫°i v√†o Function ƒë·ªÉ cho ph√©p c√°c l·ªánh async ho·∫°t ƒë·ªông
        const asyncFn = new Function(`(async () => { ${evalSafe} })()`);
        asyncFn();
      } catch (e) {
        alert("‚ùå L·ªói khi ch·∫°y m√£: " + e.message);
        console.error(e);
      }
    }
  </script>
</body>
</html>
