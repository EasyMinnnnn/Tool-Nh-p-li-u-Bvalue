<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>üß† Auto Fill Executor</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 40px auto;
      max-width: 800px;
      padding: 0 20px;
    }
    textarea {
      width: 100%;
      height: 300px;
      font-family: monospace;
      font-size: 14px;
      padding: 10px;
    }
    button {
      margin-top: 10px;
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
      background-color: #2d89ef;
      color: white;
      border: none;
      border-radius: 4px;
    }
    button:hover {
      background-color: #1b66c9;
    }
  </style>
</head>
<body>
  <h2>üß† Auto Fill Executor</h2>
  <p>D√°n ƒëo·∫°n JavaScript t·ª´ Google Sheet v√†o √¥ b√™n d∆∞·ªõi (d·∫°ng <code>=</code><code>"(function(){...})();"</code>), r·ªìi b·∫•m "Run".</p>
  <textarea id="code" placeholder='D√°n m√£ t·ª´ Google Sheets v√†o ƒë√¢y...'></textarea><br/>
  <button onclick="runCode()">‚ñ∂Ô∏è Run</button>

  <script>
    function runCode() {
      let raw = document.getElementById("code").value.trim();

      // ‚úÖ 1. X·ª≠ l√Ω d·∫•u nh√°y ti·∫øng Vi·ªát
      raw = raw
        .replace(/[‚Äú‚Äù]/g, '"')
        .replace(/[‚Äò‚Äô]/g, "'");

      // ‚úÖ 2. N·∫øu l√† chu·ªói d·∫°ng ="(function(){...})();", th√¨ b·ªè = v√† d·∫•u ngo·∫∑c ngo√†i
      if (raw.startsWith('="') && raw.endsWith('"')) {
        raw = raw.slice(2, -1); // b·ªè =" ·ªü ƒë·∫ßu v√† " ·ªü cu·ªëi
      }

      // ‚úÖ 3. Chu·∫©n h√≥a ƒë·ªÉ ch·∫°y b·∫±ng eval (escape ng∆∞·ª£c \ v√† ")
      try {
        const jsCode = JSON.parse(
          '"' + raw
            .replace(/\\/g, '\\\\')
            .replace(/"/g, '\\"')
            .replace(/\n/g, '\\n') + '"'
        );

        if (!confirm("B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën ch·∫°y ƒëo·∫°n m√£ n√†y?")) return;
        eval(jsCode);

      } catch (err) {
        alert("‚ùå L·ªói khi ch·∫°y m√£: " + err.message);
        console.error(err);
      }
    }
  </script>
</body>
</html>
